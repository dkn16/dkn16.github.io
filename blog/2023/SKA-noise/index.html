<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>An example on SKA noise generation | Kangning  Diao</title>
    <meta name="author" content="Kangning  Diao">
    <meta name="description" content="How do we generate the SKA noise">
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://dkn16.github.io/blog/2023/SKA-noise/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Kangning </span>Diao</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item active">
                <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a>
              </li>

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">publications</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/repositories/">repositories</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/cv/">cv</a>
              </li>

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container mt-5">
      <!-- _layouts/post.html -->

<div class="post">

  <header class="post-header">
    <h1 class="post-title">An example on SKA noise generation</h1>
    <p class="post-meta">July 28, 2023</p>
    <p class="post-tags">
      <a href="/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a>
        ·  
        <a href="/blog/category/observations">
          <i class="fas fa-tag fa-sm"></i> observations</a>  
          

    </p>
  </header>

  <article class="post-content">
    <p>The SKA is an inferometer where each pair of baselines measures the visibility on a single mode. The whole procedure can be devided into 3 steps: the first step is to generate the UV map distribution according to the station layout; secondly one should sample the noise ampliude on each UV mode; thirdly, one should convert the UV space observations into real space noise images using different weights. I’ll introduce this steps one by one</p>

<h2 id="uv-map-generation">UV map generation</h2>

<p>To be finished later.</p>

<h2 id="sampling-the-noise-magnitude">Sampling the noise magnitude</h2>

<p>First we assume all the baselines are identical. Each time it measures, it’ll get the true 21 cm visibility \(V_{\rm{21\ cm}}\) with a noise visibility \(V_N\) with standard deviation \(\sigma_{N}\):</p>

\[\begin{equation}
  \sigma_{N} = \frac{\lambda^2T_{\rm sys}}{\epsilon \Omega A_{\rm Dish}\sqrt{2\Delta \nu t_{\rm int}N_d}},
    \label{eqn:singnoi}
\end{equation}\]

<p>where \(\Omega\approx \theta^2\) is the beam area, \(\lambda\) is the signal wavelength, \(T_{\rm sys}\) is the system temperature of the telescope, \(\Delta \nu\) is the frequency resolution, \(t_{\rm int}\) is the integration time, \(A_{\rm Dish}\) is the physical area of station and \(\epsilon\) is an efficiency factor which follows</p>

\[\begin{align}
\begin{split}
\epsilon= \left \{
\begin{array}{ll}
    1,   &amp;\nu&lt;\nu_{\rm c}\\
   \left ( \frac{\nu_{\rm c}}{\nu}\right )^2, &amp; \nu\ge\nu_{\rm c}.
\end{array}
\right.
\end{split}
\end{align}\]

<p>However, what UV map tell us is how many times is a UV mode measured, each time with a noise \(V_{N_i}\). So you can imagine that on any UV mode \(\tilde{\mathcal{x}}\), the outcome visibility is the sum of all \(N_{uv}\) independent observations (this is called the natural weighting):
\(\begin{equation}
  V_{\rm{obs}}(\tilde{\mathcal{x}}) = N_{uv}(\tilde{\mathcal{x}})\times V_{\rm{21\ cm}}(\tilde{\mathcal{x}}) + \sum_{i=1}^{N_{uv}(\tilde{\mathcal{x}})}V_{N_i}
\label{eqn:vis}
\end{equation}\)</p>

<p>Our goal is to sample the noise amplitude, so here comes two way:</p>

<ul>
  <li>
    <p>we can simply sample the \(\sum_{i=1}^{N_{uv}(\tilde{\mathcal{x}})}V_{N_i}\). It’s simply a sum of \(N_{uv}\) Gaussian variables, equivalent to sample one Gaussian variable with std: \(\sigma_N^{\rm pixel} = \sigma_{N}\sqrt{N_{uv}}\).
In this case the sampled noise correspond to the final noise map, and no additional procedure is needed.</p>
  </li>
  <li>
    <p>Or we can transform the equation \eqref{eqn:vis} into \(V_{\rm{obs}}(\tilde{\mathcal{x}}) = N_{uv}(\tilde{\mathcal{x}})( V_{\rm{21\ cm}}(\tilde{\mathcal{x}}) + 1/N_{uv}(\tilde{\mathcal{x}})\sum_{i=1}^{N_{uv}(\tilde{\mathcal{x}})}V_{N_i})\). In this case we need to sample a Gaussian varable with std: \(\sigma_N^{\rm pixel} = \sigma_{N}/\sqrt{N_{uv}}\), and a weighting is required in the next step if not using the natural weighting.</p>
  </li>
</ul>

<p>Personally I prefer the second way: In this case I can write the final product of “observation step” as \(V_{\rm final}(\tilde{\mathcal{x}}) = V_{\rm{21\ cm}}(\tilde{\mathcal{x}}) + 1/N_{uv}(\tilde{\mathcal{x}})\sum_{i=1}^{N_{uv}(\tilde{\mathcal{x}})}V_{N_i}\), and leave all the weighting stuffs in the next section, because first “averaging” is something should be automatically performed in my mind; secondly this quatity is closest to the original \(V_{\rm{21\ cm}}\).</p>

<h2 id="weighting">Weighting</h2>

<p>After we got the \(V_{\rm final}\):</p>

\[\begin{equation}
  V_{\rm final}(\tilde{\mathcal{x}}) = V_{\rm{21\ cm}}(\tilde{\mathcal{x}}) + 1/N_{uv}(\tilde{\mathcal{x}})\sum_{i=1}^{N_{uv}(\tilde{\mathcal{x}})}V_{N_i}
\end{equation}\]

<p>The final step is transform these visibilities (in \(uv-\) space or Fourier space) to the final image. The simplest way to do this is just do a Fourier transformation. This way provided the best angular resolution (You may see it when we discuss the natural weighting later), however largest noise. Because that in those outer (far from 0 point) regions in \(uv-\) space, few baselines hit these modes. Low hits result it high noise amplitude (higher \(1/N_{uv}(\tilde{\mathcal{x}})\sum_{i=1}^{N_{uv}(\tilde{\mathcal{x}})}V_{N_i}\) in \(V_{\rm final}\)). This would lead to super-high noise amplitude oscillating in super-small scale. One way to solve this problem is adopting the “natural weighting”.</p>

<p>The idea behind natural weighting is, since some modes are hit fewer, some are hit more often, then the weight is just the hits. This is a natural way of doing the weighting, because \(N_{uv}(\tilde{\mathcal{x}})\) is the only thing we have in the above equations. In this case, these frequently measured modes become much more important, while those less hit modes become nothing. The consequense is, the noise amplitide of long modes is suppressed, but the signal is also suppressed. Thus the result has a significant lower noise, but also lack of small scale information.</p>

  </article><div id="giscus_thread" style="max-width: 800px; margin: 0 auto;">
  <script>
    let giscusTheme = localStorage.getItem("theme");
    let giscusAttributes = {
        "src": "https://giscus.app/client.js",
        "data-repo": "alshedivat/al-folio",
        "data-repo-id": "MDEwOlJlcG9zaXRvcnk2MDAyNDM2NQ==",
        "data-category": "Comments",
        "data-category-id": "DIC_kwDOA5PmLc4CTBt6",
        "data-mapping": "title",
        "data-strict": "1",
        "data-reactions-enabled": "1",
        "data-emit-metadata": "0",
        "data-input-position": "bottom",
        "data-theme": giscusTheme,
        "data-lang": "en",
        "crossorigin": "anonymous",
        "async": "",
    };


    let giscusScript = document.createElement("script");
    Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
    document.getElementById("giscus_thread").appendChild(giscusScript);
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a>
</noscript>
</div>
</div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2023 Kangning  Diao. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>.
Last updated: August 22, 2023.
      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script defer src="/assets/js/common.js"></script>
  <script defer src="/assets/js/copy_code.js" type="text/javascript"></script>

    
  <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>
  <script async src="https://badge.dimensions.ai/badge.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  </body>
</html>
