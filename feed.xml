<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="https://dkn16.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://dkn16.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2023-09-19T10:47:16+00:00</updated><id>https://dkn16.github.io/feed.xml</id><title type="html">blank</title><subtitle>A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">My basic understanding of HMC</title><link href="https://dkn16.github.io/blog/2023/HMC/" rel="alternate" type="text/html" title="My basic understanding of HMC"/><published>2023-09-18T03:32:00+00:00</published><updated>2023-09-18T03:32:00+00:00</updated><id>https://dkn16.github.io/blog/2023/HMC</id><content type="html" xml:base="https://dkn16.github.io/blog/2023/HMC/"><![CDATA[<p>The Hamitonian Monte Carlo (HMC) and its variants are almost the best sampling algorithms now, as long as you can get access to the gradient. I’ve learnt it several years ago, but soon forgot. Now I try again, to understand it in a physicist way – though i’m not a physicist.</p> <h2 id="traditional-mcmc">Traditional MCMC</h2> <p>Suppose we want to get the distribution \(V(q)\) of an variable \(q\) (let’s name it in Hamitonian way), one thing we can learn from the statistical physics is that at equilibrium state, a physical system with potential \(U(q)\) converges at \(p(q)\propto \exp^{-U(q)}\) (Assume kinetic energy is much less than the potential energy in this system). Then one can easily figure out, the distribution \(V(q)\) is equivalent to the particle distribution in a physical system with potential \(- \log V(q)\) in the equilibrium state. Suppose this state have many particles – their distribution will show us our target distribution.</p> <p>– But how do we get these particles? One solution is we need to sample all over the space. How do we do the sampling to assume every new state we sampled follows the desired distribution? `detailed balance’ can help on this. The detailed balance tells us, in the equilibrium, the transition probability from \(q_0\) to \(q_1\) and its inverse follows: \(\begin{equation} p_t(q_0 \rightarrow q_1) p(q_0) = p_t(q_1 \rightarrow q_0) p(q_1) \label{eqn:detbal} \end{equation}\) where \(p_t\) represents the transition probability. Its meaning is precise and clear: at any time, the number of transition events from \(q_1\) to \(q_0\) should be the same of \(q_0\) to \(q_1\), thus the total distribution holds. After knowing this, we can see the sampling process as a chain of transitions: a particle in this system will transit all the time, and the time evolution can be viewed as ensembles. It’s interesting that in statistical physics we use ensemble average to substitude the time average, while now we do the opposite. Now one can create a transition probability: \(\begin{equation} p_t(q_0 \rightarrow q_1) = \left\{ \begin{aligned} &amp;1 &amp;p(q_0)&lt;p(q_1) \\ &amp;\frac{p(q_1)}{p(q_0)}\ \ &amp;p(q_0)&gt;p(q_1) \end{aligned} \right. \label{eqn:tranprob} \end{equation}\) It’s not hard to check this equation is consistent with equation \eqref{eqn:detbal}.</p> <p>Then one can imagine in a physical system, a particle \(q\) will go through a bunch of states: \(\begin{equation} {\rm State}_0 \rightarrow {\rm State}_1 \rightarrow {\rm State}_2\rightarrow ... \rightarrow {\rm State}_n \label{eqn:chain} \end{equation}\) And the distribution of all these \(n\) states follows the \(V(q)\).</p> <p>Imagine we have a two-level system, with only two possible states, let’s do this process for \(n\) times: suppose \(q_0\) has lower potential energy and we start from it. Then assume process \(q_0 \rightarrow q_1\) is tried \(x\) times, the backward process must happen \(x*p(q_1)/p(q_0)\) times. So among all the samples, we have \(x*p(q_1)/p(q_0)\) \(q_1\), and \(x\) \(q_0\), and you can see it perfectly recovers the distribution.</p> <p>– But in real problem we have infinite possible states! Does this relation still holds? Yes. Suppose we run a long chain as in \eqnref{eqn:chain}, and it has come to a steady state, thus the distribution of particles \(\pi(q)\) won’t change overtime. Let’s cut the total chain into two parts: the first part is \({\rm State}_0,{\rm State}_2,{\rm State}_4,...\) and the second part is \({\rm State}_1,{\rm State}_3,{\rm State}_5,...\) and since it is long enough, we can imagine half of the total samples should also be in steady state, thus, the distribution \(\pi_1(q)\) and \(\pi_2(q)\) for both part should be the same, same as the total distribution, and more interestingly, the second part can be view as the acceptance result of part 1. So we can interpret these two parts as: first we have a sample (group 1), them we let all particles in this sample to do a transition (no matter successful or not), and we get the group 2.</p> <p>Then we just randomly choose a random position \(q_1\), in the sample, they appears \(n_1 = n*\pi(q_1)\) times. Then total successful transition from \(q_1\) to all other places is:</p> \[\begin{equation} n_{1,\rm out} = \int n*\pi(q_1)Q(q|q_1)p(q_1\rightarrow q) \ dq \end{equation}\] <table> <tbody> <tr> <td>Where $$Q(q_1</td> <td>q)\(is the probability of proposing\)q_1\(as the next destination. Samely, successful transitions from all other places to\)q_1$$ is:</td> </tr> </tbody> </table> \[\begin{equation} n_{1,\rm in} = \int n*\pi(q)Q(q_1|q)p(q\rightarrow q_1)\ dq \end{equation}\] <p>Then as we talked just now, a steady state means \(n_{1,\rm out} = n_{1,\rm in}\) at each location, thus we have:</p> \[\begin{equation} \int n*\pi(q_1)Q(q|q_1)p(q_1\rightarrow q) \ dq = \int n*\pi(q)Q(q_1|q)p(q\rightarrow q_1)\ dq \end{equation}\] <p>Differetiate both sides yield:</p> \[\begin{equation} \pi(q_1)Q(q|q_1)p(q_1\rightarrow q) = \pi(q)Q(q_1|q)p(q\rightarrow q_1) \end{equation}\] <table> <tbody> <tr> <td>Then we can see that if we just use a location proposal function \(Q\) that satifies $$Q(q</td> <td>q_1)=Q(q_1</td> <td>q)$$, then the above equation comes to:</td> </tr> </tbody> </table> \[\begin{equation} \pi(q_1)p(q_1\rightarrow q) = \pi(q)p(q\rightarrow q_1) \end{equation}\] <p>Applied the equation \eqnref{eqn:tranprob}, we can get:</p> \[\begin{equation} \pi(q_1)/p(q_1) = \pi(q)/p(q) \end{equation}\] <p>Since integration of \(\pi(q)\) and \(p(q)\) are all 1, one can find that \(\pi(q) = p(q)\) must hold. We’ve already know the desired distribution can be gained once the detailed balance is achieved, and we just proved that if we construct this chain follows the detailed balance rule, we will get the target distribution. I’ve forgotten how do we prove the equivalence between equilibrium state and detailed balance, but I guess it should be similar.</p> <p>So far so good? But the traditional MCMC have some problem, and I’ll talk about how do we deal with the problem with Hamitonian Monte-Carlo.</p>]]></content><author><name></name></author><category term="theories"/><category term="sampling"/><summary type="html"><![CDATA[Maybe appropriate for physics-background people. Some of examples are imagined by myself and could be wrong.]]></summary></entry><entry><title type="html">时间悄悄走去</title><link href="https://dkn16.github.io/blog/2023/DaYuTou/" rel="alternate" type="text/html" title="时间悄悄走去"/><published>2023-08-21T22:28:00+00:00</published><updated>2023-08-21T22:28:00+00:00</updated><id>https://dkn16.github.io/blog/2023/DaYuTou</id><content type="html" xml:base="https://dkn16.github.io/blog/2023/DaYuTou/"><![CDATA[<p>2004年秋天，吸着早晨最后一缕清凉的薄雾，走过尚且泥泞的小路，途径也许两三个臭水沟和一个臭水塘，我们一家住进了现在的这个小房子。由于在小县城，房子还算宽敞，我也从那个时候起就拥有了自己的房间。那个时候到处都很破很破，从我家到小学隔着一个小小的山坡，山坡上是曲曲折折的巷子叫做鸡爪巷，鸡爪巷的尽头下坡是一条长长的青石板街。</p> <p>上学如果不愿意上上下下地爬坡，就得绕道县城的主干道。首先是被唤作“北门汽车站”的地方，在很久很久以前那里是真正的北门，如今早就成了县城的正中心；来来回回的大巴构成了我对远方的第一印象，每年春天坐上大巴，颠儿颠儿地开上开下一个一个小土包，穿过望不到头的油菜花田就可以去大城市：芜湖或者马鞍山。如今人们蜂拥打卡的油菜花海，当时就静静开在房前屋后，寻常巷口。</p> <p>过了北门汽车站就是小时候记忆里最主干道的主干道。一条路上开着李宁乔丹安踏特步，构成了我对“大牌”的初步印象。还有“土家族酱香饼”——我第一次一个人从学校走回家，全家就分享了一张酱香饼作为庆祝。再往前，在钟楼前拐进小路，不一会就能到我小学的门口。后来读格非写的小说，经典的江南几本，总是相似的天气相似的心情，春天或者秋天，薄雾或者丝雨，吸一口气，胸口清凉而微闷。一秒把我拉回到一个个普通的上学的晨昏。似乎这样的晨昏会一直持续下去，过了一天还是一天，过了一年又是一年。</p> <p>然而在我以为我和世界都日复一日地在小床上睡懒觉的时候，时间却偷偷不停转动了。在我搬过去没多久，青石板街就消失了，拔地而起的小区以“现代”为名，带着或许确实十分现代的纯黄纯蓝的撞色墙面。“现代”像一大块菌毯，到一处就蚕食一处，我初中时蚕食了鸡爪巷，我高中时侵蚀了槐树湾，最后终于无处可去开始吞食最初的不够现代的“现代”：吞食旧的医院，旧的学校，像貔貅一样什么痕迹都不留下。</p> <p>时间真是奇妙，在我们各自的参考系里安安静静流动，任谁也逃不过；我以为我和我的父亲和我的亲戚朋友都一样静止不动，但事实却完全相反。我爸渐渐老去，我哥到了那年我爸的年纪，我比那年的我哥大了一丝，而我侄子也终于到了我当年的年纪。也许在大芋头的小脑瓜里也会有他的青石板街、油菜花海和“土家酱香饼”，我只希望这些都可以留得久一些，不要像我一样二十来岁无处可回忆。</p> <p>我每次回家都会带大芋头玩，他就像一把时间的尺，常常让我惊觉原来已经过了这么久，恍然而明白所谓的成长与衰老不过一瞬间，也许再下一个瞬间就是我带着大芋头给我孩子的新房间挪家具，也许那个时候他也会回想起从前的种种。回到小时候我第一次一个人睡的时光，彼时我每天都害怕外星人来把我抓走。远处风的呼啸，墙下发情的猫咪乱叫，都被我视作外星人的征兆，更不用说夜里天边泛着的光污染。哪想到多年以后倒期待起外星人：这哪是外星人，这就是一篇会动的nature。</p> <p>回忆里的从前是安安静静的：四年级不爱听课，看窗外的云低低飞过，指给同桌看：“你看你看，这片云最好看”；六年级的秋天早上，霜忽然就打白了一整个操场；等到初三，回忆变成了中午饭后午觉睡醒洒在脸上的懒懒阳光，电台里有情歌，我脑袋里没有烦恼。也许有吵闹的时候：“现代”吞食马路对面大片田地的时候，会带上持续不断的电钻声；周末大家都休息了，马路上还会有飞驰而过的大卡车鸣笛，以上等等不一而足。但随时间越来越远之后，就连回忆起噪声也像把耳朵按进了水里一样朦朦胧胧。不论什么时候，回想起来都是会笑的。</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/DaYuTou-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/DaYuTou-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/DaYuTou-1400.webp"/> <img src="/assets/img/DaYuTou.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <br/> <div class="caption"> 祝愿他在这里有很多年美好的日子。 </div> </div> <p>高铁快要到站，回忆也要按下暂停键了。以后时间还长，可是成长却只能长一次，能笑着一路走来，就是我一路上最大的幸福。最后祝即将一个人睡的大芋头天天都能睡好，成长快乐！</p>]]></content><author><name></name></author><category term="Travel"/><summary type="html"><![CDATA[昨晚在合肥借住在哥哥家，恰好赶上侄子“大芋头”要独立出来单独住一个房间，就帮我哥搬了点东西，收拾了下房间。2004年我家搬入新家，我第一次一个人住的时光仿佛还在眼前，转眼下一代也已经走到了这个时候。]]></summary></entry><entry><title type="html">东京一夜</title><link href="https://dkn16.github.io/blog/2023/Tokyo-ANA/" rel="alternate" type="text/html" title="东京一夜"/><published>2023-08-04T14:14:00+00:00</published><updated>2023-08-04T14:14:00+00:00</updated><id>https://dkn16.github.io/blog/2023/Tokyo-ANA</id><content type="html" xml:base="https://dkn16.github.io/blog/2023/Tokyo-ANA/"><![CDATA[<h2 id="another-sky">Another sky</h2> <p>由于众所周知的原因，去美国一共就那贵得要死几个航班，这趟美国之行转机是板上钉钉。刚好北京飞夏威夷的转机航班里，全日空是最便宜的，于是我就有幸买到了老板报销的往返一共四个起落的ANA机票（感谢老板大气！！！）。</p> <p>当我第一次坐上ANA这家全球数一数二的航司的飞机座椅的时候，环顾四周，我就被机舱的整洁震惊到了。在这架12.4年机龄的763ER上，我看到了无比通透的舷窗，斜斜地看过去，窗户上既无划痕，也没有人体/餐食上的油脂留下的大团晕染出去的模糊痕迹。感觉这架飞机一定是被用心对待了吧————作为一个深深喜爱飞机的人，感觉到由衷的开心。</p> <p>第一段落地成田很顺利，落地之后就开始播放感谢登机的宣传片：在机坪上站着各个部门的员工，摄影师的镜头记录了他们认真工作的样子————航食、清洁、空姐、地勤、飞行员…每个工种都会被看见，也都值得被看见。更让我惊喜的是背景音乐配上的是葉加瀬太郎作曲的Another sky，钢琴开场就是清新的旋律，配上小提琴缓缓拉动的旋律，就像躺在深蓝色的天空上疾驶，带着自由的感觉，远行的兴奋，归家的安心缠绕在一起，作为每次出行的BGM再合适不过，即使在旅行结束的多日以后，旋律依旧在我脑海里挥之不去。</p> <p>我很惊讶在全日空50周年的时候，他们愿意找一位专业的作曲家写一首这么动听的曲子，我也很惊讶他们愿意花如此多的时间，把飞机保养得干干净净。我想除了工作之外，他们一定很热爱这个事业吧————不热爱的话，我想断断是不可坚持下来的。碰巧前两天又看到日航破产重生的经历，稻盛和夫主持日航重建的时候去基层调研，视频里只有唯一一句话被我深深记住了：“他发现员工仍然为在日航工作而骄傲”。我不是为资本家洗地怎么样，但我确实是觉得真正做好一个工作和为工作而骄傲一定是伴生的，做好一份自己热爱的工作并为之骄傲，再拿到做好一份工作对应的丰厚收入，世界本该是这样。</p> <p>每次想到这里我总感觉到深深的幸运：我所拥有而大部分人没有的幸运，就是我在做我喜欢的事。时常会听到人说很喜欢看星空，看宇宙，每次看到宇宙很渺小的时候，都会感觉心里也安静下来，亲测我自己除了找不到工作的焦虑，感觉任何的事情也就那样，天大的事情，一辈子的事情，我随手画张图，都跑不出这图里的一个像素点，又有什么好烦恼的呢？</p> <h2 id="市内涩谷秋叶原">市内：涩谷&amp;秋叶原</h2> <p>羽田下了飞机就直奔涩谷十字路口，见识熙熙攘攘的人群。天色将暗未暗，刚好衬的霓虹灯牌闪烁炫目。在各处的风景里这儿是极独特的一份：“人”往往以干扰物的身份出席，而这儿的人组成了繁忙而有秩序的路口，自成了风景的一部分。第一次见到这里是在女神异闻录里，雨宫莲上学放学必去的地方，也是他和同伴相见的地方。四五个路口里，我毫不知道哪个是中央大街，于是信步走进了其中一处。在巷子里一个很日本的小地下室，我们吃了这天的晚饭–一盘烧鸟下肚，唯一的念头就是“烧鸟正统在上海”。上海的饮食就是贵但好吃，比北京的贵且难吃要好上不少。我想要是我在上海，今天的晚饭断然不会沦落到不知道去哪吃的地步。</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/shibuya-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/shibuya-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/shibuya-1400.webp"/> <img src="/assets/img/shibuya.jpeg" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="caption"> 涩谷十字路口。 </div> </div> <p>来东京第二个不可不去的地方就是秋叶原了，作为崩铁的玩家本来想打卡一下崩铁的广告，没想到已经全部撤下了，倒是原神大大的派蒙广告依然坚挺。不知道为什么，这里遍地都是拉客去女仆咖啡厅的女仆，很难想象日本人为什么会喜欢这种东西–男性喜欢女人再正常不过，但为什么要去看一个陌生女性穿成奇怪的样子和自己发生奇怪的互动呢？我甚至不敢和她们发生眼神接触，只能快步逃离；我甚至不太喜欢女仆，在小珺家住着的时候，阿姨来打扫卫生我总是诚惶诚恐，感觉不应该麻烦别人，但这样阿姨又挣不到钱，我觉得我可以这样：房子我自己打扫，但是给阿姨钱让她监督我（x。有次飞东航，240块升了个商务舱，空姐蹲着和我讲话的时候我更觉得不适。日本人不是也是一般不愿意麻烦别人的嘛，咋还能心安理得地来这种地方捏？</p> <h2 id="离开的羽田机场">离开的羽田机场</h2> <p>翌日我们一早就去了羽田机场准备登机，老实说羽田方方面面震惊我了。刚从单轨电车上下来进t3之后，迎面的就是干净亮堂的巨大值机大厅；早已值过机的我们快步走向安检窗口。能感受到的是虽然地方不大，但室内的卫生一尘不染，其次新装修的照明设计更是大放异彩，把一尘不染的纯白大厅照得如同梦境。回想最近我在国内走过的机场，也许是出于耐脏的角度，无一例外有些泛黄或偏暗，很难有一个如羽田一样的设计。首都机场就更不用说–这么多年的使用之后，已经到处都是岁月的痕迹；空调系统在最热的日子里已经不太能胜得过阳光，大理石地板也不再像镜面一样闪耀。</p> <p>算下来这趟唯一的遗憾就是虽然早就听说羽田有看飞机专用的观景台，今天却没时间前往观看。天天在b站上看飞友在羽田拍飞机，真到自己去了却失之交臂，未免有些遗憾。每次在视频里看到小朋友们在观景台看飞机都能感慨，有的人从小就有机会接触到这些，而我第一次看到飞机并坐上飞机已经是16岁。再往前我也会看飞机，只不过是躺在长满野草的操场中间，安安静静地看飞机从高空飞过，不知道从哪里来，也不知道会飞到哪里。</p> <p>人生到处知何似，应似操场看飞机。多年以后，我也终于坐在飞机上踌躇满志地去往目的地，去一个个新的远方。也许我也在飞机上飞过了很多个操场，沿途尽是孩子的目光。再很久很久以后，到了走不动道的年纪，我反而开始期待能回到当初的操场，目送更多年轻人认识世界，改造世界。</p>]]></content><author><name></name></author><category term="Travel"/><summary type="html"><![CDATA[从Hawaii开会回来的时候，因为航班原因被迫在东京转机了一个晚上。趁着这个机会找ANA小姐姐要了一张Shore Pass，进了市区逛了一下。]]></summary></entry><entry><title type="html">An example on SKA noise generation</title><link href="https://dkn16.github.io/blog/2023/SKA-noise/" rel="alternate" type="text/html" title="An example on SKA noise generation"/><published>2023-07-28T14:14:00+00:00</published><updated>2023-07-28T14:14:00+00:00</updated><id>https://dkn16.github.io/blog/2023/SKA-noise</id><content type="html" xml:base="https://dkn16.github.io/blog/2023/SKA-noise/"><![CDATA[<p>The SKA is an inferometer where each pair of baselines measures the visibility on a single mode. The whole procedure can be devided into 3 steps: the first step is to generate the UV map distribution according to the station layout; secondly one should sample the noise ampliude on each UV mode; thirdly, one should convert the UV space observations into real space noise images using different weights. I’ll introduce this steps one by one</p> <h2 id="uv-map-generation">UV map generation</h2> <p>To be finished later.</p> <h2 id="sampling-the-noise-magnitude">Sampling the noise magnitude</h2> <p>First we assume all the baselines are identical. Each time it measures, it’ll get the true 21 cm visibility \(V_{\rm{21\ cm}}\) with a noise visibility \(V_N\) with standard deviation \(\sigma_{N}\):</p> \[\begin{equation} \sigma_{N} = \frac{\lambda^2T_{\rm sys}}{\epsilon \Omega A_{\rm Dish}\sqrt{2\Delta \nu t_{\rm int}N_d}}, \label{eqn:singnoi} \end{equation}\] <p>where \(\Omega\approx \theta^2\) is the beam area, \(\lambda\) is the signal wavelength, \(T_{\rm sys}\) is the system temperature of the telescope, \(\Delta \nu\) is the frequency resolution, \(t_{\rm int}\) is the integration time, \(A_{\rm Dish}\) is the physical area of station and \(\epsilon\) is an efficiency factor which follows</p> \[\begin{align} \begin{split} \epsilon= \left \{ \begin{array}{ll} 1, &amp;\nu&lt;\nu_{\rm c}\\ \left ( \frac{\nu_{\rm c}}{\nu}\right )^2, &amp; \nu\ge\nu_{\rm c}. \end{array} \right. \end{split} \end{align}\] <p>However, what UV map tell us is how many times is a UV mode measured, each time with a noise \(V_{N_i}\). So you can imagine that on any UV mode \(\tilde{\mathcal{x}}\), the outcome visibility is the sum of all \(N_{uv}\) independent observations (this is called the natural weighting): \(\begin{equation} V_{\rm{obs}}(\tilde{\mathcal{x}}) = N_{uv}(\tilde{\mathcal{x}})\times V_{\rm{21\ cm}}(\tilde{\mathcal{x}}) + \sum_{i=1}^{N_{uv}(\tilde{\mathcal{x}})}V_{N_i} \label{eqn:vis} \end{equation}\)</p> <p>Our goal is to sample the noise amplitude, so here comes two way:</p> <ul> <li> <p>we can simply sample the \(\sum_{i=1}^{N_{uv}(\tilde{\mathcal{x}})}V_{N_i}\). It’s simply a sum of \(N_{uv}\) Gaussian variables, equivalent to sample one Gaussian variable with std: \(\sigma_N^{\rm pixel} = \sigma_{N}\sqrt{N_{uv}}\). In this case the sampled noise correspond to the final noise map, and no additional procedure is needed.</p> </li> <li> <p>Or we can transform the equation \eqref{eqn:vis} into \(V_{\rm{obs}}(\tilde{\mathcal{x}}) = N_{uv}(\tilde{\mathcal{x}})( V_{\rm{21\ cm}}(\tilde{\mathcal{x}}) + 1/N_{uv}(\tilde{\mathcal{x}})\sum_{i=1}^{N_{uv}(\tilde{\mathcal{x}})}V_{N_i})\). In this case we need to sample a Gaussian varable with std: \(\sigma_N^{\rm pixel} = \sigma_{N}/\sqrt{N_{uv}}\), and a weighting is required in the next step if not using the natural weighting.</p> </li> </ul> <p>Personally I prefer the second way: In this case I can write the final product of “observation step” as \(V_{\rm final}(\tilde{\mathcal{x}}) = V_{\rm{21\ cm}}(\tilde{\mathcal{x}}) + 1/N_{uv}(\tilde{\mathcal{x}})\sum_{i=1}^{N_{uv}(\tilde{\mathcal{x}})}V_{N_i}\), and leave all the weighting stuffs in the next section, because first “averaging” is something should be automatically performed in my mind; secondly this quatity is closest to the original \(V_{\rm{21\ cm}}\).</p> <h2 id="weighting">Weighting</h2> <p>After we got the \(V_{\rm final}\):</p> \[\begin{equation} V_{\rm final}(\tilde{\mathcal{x}}) = V_{\rm{21\ cm}}(\tilde{\mathcal{x}}) + 1/N_{uv}(\tilde{\mathcal{x}})\sum_{i=1}^{N_{uv}(\tilde{\mathcal{x}})}V_{N_i} \end{equation}\] <p>The final step is transform these visibilities (in \(uv-\) space or Fourier space) to the final image. The simplest way to do this is just do a Fourier transformation. This way provided the best angular resolution (You may see it when we discuss the natural weighting later), however largest noise. Because that in those outer (far from 0 point) regions in \(uv-\) space, few baselines hit these modes. Low hits result it high noise amplitude (higher \(1/N_{uv}(\tilde{\mathcal{x}})\sum_{i=1}^{N_{uv}(\tilde{\mathcal{x}})}V_{N_i}\) in \(V_{\rm final}\)). This would lead to super-high noise amplitude oscillating in super-small scale. One way to solve this problem is adopting the “natural weighting”.</p> <p>The idea behind natural weighting is, since some modes are hit fewer, some are hit more often, then the weight is just the hits. This is a natural way of doing the weighting, because \(N_{uv}(\tilde{\mathcal{x}})\) is the only thing we have in the above equations. In this case, these frequently measured modes become much more important, while those less hit modes become nothing. The consequense is, the noise amplitide of long modes is suppressed, but the signal is also suppressed. Thus the result has a significant lower noise, but also lack of small scale information.</p>]]></content><author><name></name></author><category term="observations"/><category term="observations"/><summary type="html"><![CDATA[How do we generate the SKA noise]]></summary></entry><entry><title type="html">21厘米宇宙学笔记-2.1 21厘米辐射转移中的基础定义</title><link href="https://dkn16.github.io/blog/2021/21cm-physics/" rel="alternate" type="text/html" title="21厘米宇宙学笔记-2.1 21厘米辐射转移中的基础定义"/><published>2021-04-25T14:14:00+00:00</published><updated>2021-04-25T14:14:00+00:00</updated><id>https://dkn16.github.io/blog/2021/21cm-physics</id><content type="html" xml:base="https://dkn16.github.io/blog/2021/21cm-physics/"><![CDATA[<blockquote> <p>本文是基于 <a href="https://arxiv.org/abs/astro-ph/0608032">Friedmann, Oh, Briggs 2006</a> 的中文学习笔记，可能部分内容不是最新结果/有误，欢迎指正。</p> </blockquote> <h2 id="21cm信号辐射转移方程">21cm信号辐射转移方程</h2> <p>本节假设读者已有辐射转移基础，i.e. 已读完Rybicki-Lightman第一章内容）</p> <p>因为经历了长时间的演化，我们可以假设在宇宙再电离时期的星系际介质中，所有的中性氢分子云的基态超精细结构能级分布都处于平衡态，并具有温度\(T_S\)，(其又被称之为自旋温度，我猜是因为它决定了总自旋态的分布）。温度是用来刻画能级排布的，根据我们的统计力学知识，这一条件意味着原子气体中的中性氢作为一个两能级系统，其高能态和低能态的排布遵循</p> \[\frac{n_1}{n_0}=\frac{g_1}{g_0}e^{-h\nu/kT_S}\] <p>然后基于辐射转移的知识，我们可以写出辐射转移的积分方程：</p> <p>\(I_\nu(\tau)=I_\nu(0)e^{-\tau}+S_\nu(1-e^{-\tau})\)。</p> <p>其中\(I_\nu(\tau)\)是我们关心的Intensity在光深\(\tau\)处的值，而\(S_\nu\)是source function。我们知道在热平衡的假设下，</p> \[S_\nu=B_{\nu}(T)\] <p>，\(B_{\nu}(T)\) 就是在温度\(T\) ，频率 \(\nu\)下的黑体辐射强度。</p> <p>此处插一句，在瑞利-金斯极限下，有:</p> \[B_\nu(T_S)\approx\frac{2\nu^2}{c^2}kT_{S}\] <p>因此我们可以对\(I_{\nu}\)作同样的分解，即：</p> \[I_\nu(\tau)\approx\frac{2\nu^2}{c^2}kT_{b}(\tau)\] <p>这样我们只需要研究\(T_b\)和\(T_S\)的关系了（其实我还是没懂这个变换的必要性）。</p> <p>而相应地，原方程可以化为 \(\begin{equation} \label{eqn:cont} T_b(\tau)=T_b(0)e^{-\tau}+T_S(1-e^{-\tau}) \end{equation}\) 这个方程中，\(T_b(0)\)是来自背景的21cm辐射，背景辐射主要来自于CMB光，具有温度$T_\gamma$；在接下来的章节中我们可以看到如何计算$T_S$；所以剩下的变量就是光深$\tau$。</p> <p>光深\(\tau\)，根据定义，有：</p> \[\tau=\int\alpha_\nu ds\] <p>其中 \(\alpha_\nu\)是吸收系数，s是光所穿行的距离。其可以用爱因斯坦系数表示为（爱因斯坦系数定义及关系参见R-L chpt1.6） \(\begin{eqnarray} \alpha_\nu=\frac{h\nu}{4\pi}\phi(\nu)(n_0B_{01}-n_1B_{10})\\=\frac{h\nu}{4\pi}\phi(\nu)(n_0\frac{g_1}{g_0}-n_1)B_{10}\\=\frac{c^2}{8\pi\nu^2}\phi(\nu)(3n_0-n_1)A_{10}\\=\frac{c^2A_{10}}{8\pi\nu^2}\phi(\nu)3n_0(1-\frac{g_0n_1}{g_1n_0})\\=\frac{3c^2A_{10}}{8\pi\nu^2}\phi(\nu)n_0(1-e^{-h\nu/kT_S}) \end{eqnarray}\) 定义\(\sigma_{01}=\frac{3c^2A_{10}}{8\pi\nu^2}\)，可以得到</p> \[\alpha_\nu=\sigma_{01}\phi(\nu)n_0(1-e^{-h\nu/kT_S})\] <p>对该式积分，理想状态下这些都是常数，因此积分后可以得到</p> \[\begin{eqnarray} \tau=\sigma_{01}\phi(\nu)N_0(1-e^{-h\nu/kT_S})\\\approx\sigma_{01}\phi(\nu)\frac{N_{\rm HI}}{4}(1-e^{-h\nu/kT_S})\\\approx\sigma_{01}\phi(\nu)\frac{x_{\rm HI}N_{\rm H}}{4}(1-e^{-h\nu/kT_S}) \end{eqnarray}\] <p>假设\(h\nu\ll kT_S\)，原式化为</p> \[\tau=\sigma_{01}\phi(\nu)\frac{x_{\rm HI}N_{\rm H}}{4}\left(\frac{h\nu}{kT_S}\right)\] <p>式中HI表示中性氢，H表示中性+电离氢，\(N\)表示column density，\(x_{\rm HI}\)表示中性氢占总氢原子的数目比例。在上式中，大部分都是常数，数值模拟可以给出各处的\(N_{\rm H}\)和\(x_{\rm HI}\)，因此计算光深最后的阻碍就是\(\phi(\nu)\)。</p> <p>一旦需要考虑\(\phi(\nu)\)，事情就变得复杂起来。考虑一团均匀的、静止的气体，其内部存在自然展宽和多普勒展宽。不仅如此，Hubble Flow还给这团气体施加了一个额外速度。21cm的$A_{01}$非常小，因此自然展宽可以不用太考虑。为了简化这个问题，我们换一种思路：速度会让原子发出的光处于不同的</p> <p>这里首先考虑hubble flow和别的原因引起的气体整体运动，导致距气体中心共动距离\(s\)处的气体发光实际中心频率为\(\nu=\nu_{0}(1-\frac{H(z)s}{c}+\frac{v_{\parallel}}{c})\)</p> <p>式中\(v_{\parallel}\)是沿视线方向，气体整体的运动速度。我们在该处假设一个宽度为\(\nu_D\)的多普勒展宽（我们将会看到实际上展宽基本没影响），其可以写为</p> \[\begin{eqnarray} \phi(\nu)=\frac{1}{\Delta\nu_D\sqrt{\pi}}e^{-\frac{(\nu-\nu_0)^2}{\Delta\nu_D^2}}\\ =\frac{1}{\Delta\nu_D\sqrt{\pi}}e^{-\frac{\nu_{0}^2}{c^2\Delta\nu_D^2}(-H(z)s+v_{\parallel})^2} \end{eqnarray}\] <p>其中s是距中心处的共动距离。将其代入原式积分，可以得到</p> \[\tau=\sigma_{01}\frac{x_{\rm HI}N_{\rm H}}{4}\left(\frac{h\nu}{kT_S}\right)\int\phi(\nu)ds\] <p>其中积分项</p> \[\begin{eqnarray} \int\phi(\nu)ds &amp;=&amp; \int\frac{1}{\Delta\nu_D\sqrt{\pi}}e^{-\frac{\nu_{0}^2}{c^2\Delta\nu_D^2}(-H(z)s+v_{\parallel})^2}ds\\ &amp;=&amp;\int\frac{1}{\Delta\nu_D\sqrt{\pi}}e^{-\frac{\nu_{0}^2}{c^2\Delta\nu_D^2}(-H(z)s+v_{\parallel})^2}\frac{ds}{d(H(z)s-v_{\parallel})}d(H(z)s-v_{\parallel})\\ &amp;=&amp;\int\frac{1}{\Delta\nu_D\sqrt{\pi}}e^{-\frac{\nu_{0}^2}{c^2\Delta\nu_D^2}(-H(z)s+v_{\parallel})^2}\frac{1}{(H(z)-dv_{\parallel}/ds_{\parallel})}d(H(z)s-v_{\parallel}) \end{eqnarray}\] <p>我们假设\(\frac{1}{(H(z)-dv_{\parallel}/ds_{\parallel})}\)是个常数，则剩余部分积分为\(\frac{c}{\nu_0}\)。代入原积分可得：</p> \[\begin{eqnarray} \tau=\sigma_{01}\frac{x_{\rm HI}N_{\rm H}}{4}\left(\frac{h\nu}{kT_S}\right)\frac{c}{\nu_0(H(z)-dv_{\parallel}/ds_{\parallel})}\\=\frac{3hc^3A_{10}}{32\pi kT_S\nu_0^2}\frac{x_{\rm HI}n_{\rm H}}{H(z)-dv_{\parallel}/ds_{\parallel}} \end{eqnarray}\] <p>至此我们就推导出了21cm信号的基本表达式。</p> <h2 id="辐射转移方程在实际中的应用">辐射转移方程在实际中的应用</h2> <p>在两个场景下，辐射转移方程的结果可以被观测到。</p> <ul> <li>在CMB背景下星系际介质的21cm发射/吸收线</li> </ul> <p>在这种情况下，考虑方程\eqref{eqn:cont}，光深0处的入射光\(T_{b}(0)\)即CMB光子\(T_{\gamma}\)。而此时我们观测到的量就是相对CMB的发射/吸收\(\delta T_{b}\)</p> \[\begin{eqnarray} \delta T_b(z)&amp;=&amp;\frac{T_b(z)-T_\gamma(z)}{1+z}\\ &amp;=&amp;\frac{1}{1+z}(T_S(1-e^{-\tau})-T_\gamma(1-e^{-\tau}))\\ &amp;=&amp;\frac{T_S-T_\gamma}{1+z}(1-e^{-\tau}) \end{eqnarray}\] <p>在光学薄的假设下，\(1-e^{-\tau}=\tau\)，因此原式可化为</p> \[\begin{eqnarray} \delta T_b(z)&amp;=&amp;\frac{T_S-T_\gamma}{1+z}\tau\\ &amp;=&amp;\frac{3hc^3A_{10}}{32\pi k\nu_0^2}\frac{x_{\rm HI}n_{\rm H}}{H(z)-dv_{\parallel}/ds_{\parallel}}\frac{T_S-T_\gamma}{(1+z)T_S} \end{eqnarray}\] <p>该式正是文献中（如 <a href="https://link.springer.com/content/pdf/10.1007/s10686-013-9334-5.pdf">Mellema et al. 2003</a>）的表达式。也是21cm宇宙学中，最常用的表达式之一。</p> <ul> <li>21cm森林</li> </ul> <p>假设背景光不是CMB光子，而是一个极亮射电源，那么背景光穿过气体时，气体本身的发射就可以忽略，唯一重要的就是对背景光的吸收。这种情况下，射电源的光谱中会有大量的吸收线，表征了星系际介质各处氢原子的状态。类似于Lyman-\(\alpha\)森林，这种射电谱被叫做21cm森林。</p> <h2 id="自旋温度的影响因素">自旋温度的影响因素</h2> <p>自旋温度表征的时各能态上氢原子的数密度，那么为了计算自旋温度，首先我们得知道有哪些因素可以改变氢原子的精细结构。在这件事情上，人们主要考虑了三种影响因素。最简单的当然就是之前一直在说的两能级系统内的跃迁和吸收了，其次还有碰撞和光子-电子散射。碰撞导致超精细结构改变举例而言就是，假设有一个质子电子自旋都向上的氢原子，另有一个都向下的氢原子，二者碰撞交换了各自的电子，我们就有了俩自旋一上一下的氢原子。而光子-电子散射使其超精细结构改变主要原因是这种散射会把电子散射到高能态，当电子从高能态跃迁回基态时，其自旋可能发生改变，结果就是超精细结构的改变。</p> <p>如果只考虑这三个效应，那么我们可以写出这样的细致平衡</p> \[\begin{equation} \label{eqn:db} n_0(B_{01}I_{\nu}+C_{01}+P_{01})=n_1(A_{10}+B_{10}I_{\nu}+C_{10}+P_{10}) \end{equation}\] <p>不难看出，这里除了爱因斯坦AB系数之外，我写的\(P_{ij}\)的意思是通过光子-电子散射使系统从i态到j态的概率，而\(C_{ij}\)指的是通过碰撞从i态到j态的概率。而21cm的辐射强度远小于CMB，因此\(I_{\nu}\)可以认为几乎是\(I_{CMB}\)。</p> <p>仿照之前\(n_1/n_0\)的关系，我们同样可以把\(C_{10}\)和\(C_{01}\)的关系写成</p> \[\frac{C_{01}}{C_{10}}=\frac{g_1}{g_0}e^{h\nu/kT_{K}}\approx3(1-\frac{h\nu}{kT_K})\] <p>至于为什么是\(g_1/g_0\)，我们可以想象在无穷高的温度下，从1到0态和从0到1态一样轻松。这个时候由于1态实际上有三个态，从0到1态的概率就是从1到0态概率的3倍。那么我们这么写出来之后，就可以用\(T_{K}\)指代碰撞效应的强度了。</p> <p>同样地，可以写出</p> \[\frac{P_{01}}{P_{10}}=\frac{g_1}{g_0}e^{h\nu/kT_{c}}\approx3(1-\frac{h\nu}{kT_c})\] <p>这里\(T_{c}\)表征了光子-电子作用的强度。</p> <p>那么式\eqref{eqn:db}实际上可以写成</p> \[\frac{n_1}{n_0}=\frac{B_{01}I_{\nu}+C_{01}+P_{01}}{A_{10}+B_{10}I_{\nu}+C_{10}+P_{10}}\] \[LHS\approx3(1-\frac{h\nu}{kT_S})\] \[\begin{eqnarray} RHS=\frac{B_{01}I_{\nu}+C_{01}+P_{01}}{(1+\frac{kT_\gamma}{h\nu})A_{10}+C_{10}+P_{10}} \\=\frac{3(1+\frac{kT_\gamma}{h\nu}-1)A_{10}+C_{10}3(1-\frac{h\nu}{kT_K})+P_{10}3(1-\frac{h\nu}{kT_c})}{(1+\frac{kT_\gamma}{h\nu})A_{10}+C_{10}+P_{10}} \\=3\left(1-\frac{A_{10}+C_{10}\frac{h\nu}{kT_K}+P_{10}\frac{h\nu}{kT_c}}{(1+\frac{kT_\gamma}{h\nu})A_{10}+C_{10}+P_{10}}\right) \end{eqnarray}\] <p>连立起来</p> \[\begin{eqnarray} \frac{h\nu}{kT_S}=\frac{A_{10}+C_{10}\frac{h\nu}{kT_K}+P_{10}\frac{h\nu}{kT_c}}{(1+\frac{kT_\gamma}{h\nu})A_{10}+C_{10}+P_{10}} \\\frac{1}{T_S}=\frac{A_{10}\frac{k}{h\nu}+C_{10}T_K^{-1}+P_{10}T_c^{-1}}{(1+\frac{kT_\gamma}{h\nu})A_{10}+C_{10}+P_{10}} \end{eqnarray}\] <p>如果我们忽略自发辐射A系数（可以计算出\(\frac{2h\nu^3}{c^2}\ll 1\)），上式可化简为</p> \[\begin{eqnarray} \frac{1}{T_S}=\frac{A_{10}\frac{k}{h\nu}+C_{10}T_K^{-1}+P_{10}T_c^{-1}}{\frac{kT_\gamma}{h\nu}A_{10}+C_{10}+P_{10}}\\ \frac{1}{T_S}=\frac{T_{\gamma}^{-1}+\frac{h\nu C_{10}}{kT_\gamma A_{10}}T_K^{-1}+\frac{h\nu P_{10}}{kT_\gamma A_{10}}T_c^{-1}}{1+\frac{h\nu C_{10}}{kT_\gamma A_{10}}+\frac{h\nu P_{10}}{kT_\gamma A_{10}}} \end{eqnarray}\] <p>如果我们定义两个表征影响的系数：</p> <ul> <li>\(x_{\alpha}=\frac{h\nu C_{10}}{kT_\gamma A_{10}}\): 表征碰撞对于\(T_{S}\)的影响</li> <li>\(x_{c}=\frac{h\nu P_{10}}{kT_\gamma A_{10}}\): 表征光子-电子散射对于\(T_{S}\)的影响</li> </ul> <p>那么原式可化为 \(\frac{1}{T_S}=\frac{T_{\gamma}^{-1}+x_{\alpha}T_K^{-1}+x_{c}T_c^{-1}}{1+x_{\alpha}+x_{c}}\) 如果我们能把等式右边这些系数和温度都求出来，我们就知道\(T_{S}\)啦（x</p>]]></content><author><name></name></author><category term="21cmphysics"/><summary type="html"><![CDATA[(In Chinese) Simple physics behind 21 cm line.]]></summary></entry></feed>